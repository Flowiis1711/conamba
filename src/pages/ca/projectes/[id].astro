---
import Layout from "@layouts/Layout.astro";
import { getCollection } from "astro:content";
import Nav from "@components/Nav.astro";
import Splider from "@components/Splider.astro";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { id: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { data } = project;
const { title, location, startYear, endYear, sponsor, images, mainImage } =
  data;
---

<Layout
  title={`${title} - Projectes Conamba`}
  description={`Detall del projecte ${title}`}
  lang="ca"
>
  <Nav />
  <div
    class="bg-white py-[2rem] px-2 w-11/12 m-auto my-5 max-w-screen-lg md:w-10/12 md:py-[4rem] md:px-[2rem] md:my-20"
  >
    <div class="m-auto w-11/12 flex flex-col md:w-[10/12]">
      <h1 class="text-2xl font-semibold uppercase mb-[2rem] md:text-4xl">
        {title}
      </h1>
      <div class="flex gap-2 text-lg">
        <span class="font-semibold">Ubicaci칩n: </span>
        <span>{location}</span>
      </div>
      <div class="flex gap-2 text-lg">
        <span class="font-semibold">A침o inicio: </span>
        <span>{startYear}</span>
      </div>
      <div class="flex gap-2 text-lg">
        <span class="font-semibold">A침o finalizaci칩n: </span>
        <span>{endYear}</span>
      </div>
      <div class="flex gap-2 text-lg">
        <span class="font-semibold">Patrocinador: </span>
        <span>{sponsor}</span>
      </div>
      <Splider images={images}/>
    </div>
  </div>
  <div
    class="w-full absolute bottom-0 left-0 h-3/6 -z-10"
    style={`background-image:url('/projects${mainImage.url}'); background-size: cover;`}
  >
  </div>
</Layout>

<script>
  import "@splidejs/splide/css";
  import Splide from "@splidejs/splide";
  document.addEventListener("DOMContentLoaded", function () {
    var splide = new Splide(".splide", {
      perMove: 1,
      perPage: 2,
      gap: ".5rem",
      drag: true,
      rewind: true,
      breakpoints: {
        768: {
          perPage: 1,
          gap: 0,
        },
      },
    });
    splide.mount();
  });
</script>
